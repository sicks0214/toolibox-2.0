# ğŸ“˜ æ’ä»¶å·¥å…·æ¥å…¥ä¸»ç«™éƒ¨ç½²æŒ‡ç¤ºæ–‡æ¡£ v2.0ï¼ˆMarkdown ç‰ˆï¼‰

## ç›®å½•

1. æ¶æ„å‰æï¼ˆå¼ºåˆ¶ï¼Œä¸å¯è¿åï¼‰
2. æ’ä»¶å¼€å‘é˜¶æ®µï¼ˆæœ¬åœ°ï¼‰
3. æ’ä»¶æ¥å…¥ä¸»ç«™ï¼ˆå”¯ä¸€æ­£ç¡®æ–¹æ³•ï¼‰
4. æ’ä»¶æ¥å…¥åçš„ç³»ç»Ÿè¡Œä¸º
5. éƒ¨ç½²é˜¶æ®µï¼ˆç”Ÿäº§/VPSï¼‰
6. æ˜ç¡®ç¦æ­¢çš„é”™è¯¯åšæ³•
7. AI å»ºè®®æ ¡éªŒè§„åˆ™
8. æ’ä»¶éƒ¨ç½²è‡ªæ£€æ¸…å•
9. æ ¸å¿ƒåŸåˆ™
10. æ’ä»¶ UI è§„èŒƒï¼ˆui.json / schema.json / plugin.jsonï¼‰
11. æ–‡æ¡£åœ°ä½

---

## 1. æ¶æ„å‰æï¼ˆå¼ºåˆ¶ï¼Œä¸å¯è¿åï¼‰

æœ¬é¡¹ç›®ä¸ºï¼š

* å•ä½“å‰ç«¯ï¼ˆNext.jsï¼Œ3000ï¼‰
* å•ä½“åç«¯ï¼ˆNode.js / Expressï¼Œ8000ï¼‰
* æ’ä»¶ = åç«¯ä»£ç æ¨¡å—

ç”Ÿäº§ç¯å¢ƒï¼š

* ä¸å­˜åœ¨æ’ä»¶ç‹¬ç«‹è¿è¡Œ
* ä¸å­˜åœ¨æ’ä»¶ç‹¬ç«‹ç«¯å£
* ä¸å­˜åœ¨æ’ä»¶ç‹¬ç«‹éƒ¨ç½²
* ä¸å­˜åœ¨ç¬¬äºŒä¸ªå·¥å…·æœåŠ¡

æ’ä»¶æœ€ç»ˆå¿…é¡»è¿è¡Œåœ¨ä¸»åç«¯è¿›ç¨‹ä¸­ã€‚

---

## 2. æ’ä»¶å¼€å‘é˜¶æ®µï¼ˆæœ¬åœ°ï¼‰

æœ¬åœ°æ¨èç»“æ„ï¼š

```
local-dev/{plugin}/
â”œâ”€â”€ plugin.json
â”œâ”€â”€ schema.json
â”œâ”€â”€ ui.json
â””â”€â”€ handler/
    â””â”€â”€ index.ts
```

æœ¬åœ°å…è®¸ï¼š

* mock server
* å•ç‹¬è°ƒè¯• handler
* ä¸´æ—¶ç«¯å£
* å•å…ƒæµ‹è¯•

ä½†è¿™äº›ä¸ä¼šå½±å“æœ€ç»ˆéƒ¨ç½²æ–¹å¼ã€‚

---

## 3. æ’ä»¶æ¥å…¥ä¸»ç«™ï¼ˆå”¯ä¸€æ–¹å¼ï¼‰

æ¥å…¥æ–¹å¼ï¼š

```
å¤åˆ¶æ’ä»¶ç›®å½• â†’ backend/plugins/{plugin}/
```

ç»“æ„ï¼š

```
backend/plugins/{plugin}/
â”œâ”€â”€ plugin.json
â”œâ”€â”€ schema.json
â”œâ”€â”€ ui.json
â””â”€â”€ handler/index.ts
```

æ¥å…¥åæ— éœ€ï¼š

* ä¿®æ”¹å‰ç«¯
* ä¿®æ”¹è·¯ç”±
* æ–°å¢ç«¯å£
* æ–°å»ºæœåŠ¡

å”¯ä¸€éœ€è¦çš„æ­¥éª¤ï¼š

```
é‡å¯åç«¯æœåŠ¡
```

---

## 4. æ’ä»¶æ¥å…¥åçš„ç³»ç»Ÿè¡Œä¸º

æ’ä»¶æ¥å…¥åç³»ç»Ÿè‡ªåŠ¨å®Œæˆï¼š

1. æ‰«æ `backend/plugins/*`
2. åŠ è½½ JSON å…ƒæ•°æ®
3. æ³¨å†Œ APIï¼š

   ```
   POST /api/{category}/{slug}
   ```
4. `/api/plugins` è‡ªåŠ¨åŒ…å«å·¥å…·ä¿¡æ¯
5. å‰ç«¯è‡ªåŠ¨ç”Ÿæˆï¼š

   * å·¥å…·å¡ç‰‡
   * å·¥å…·é¡µ URL
   * SEO
   * UIï¼ˆä¾èµ– ui.json + schema.jsonï¼‰

è‹¥ JSON ä¸åˆæ³• â†’ è‡ªåŠ¨é™çº§ä¸ºç®€æ˜“ fallback UIã€‚

---

## 5. éƒ¨ç½²é˜¶æ®µï¼ˆç”Ÿäº§/VPSï¼‰

å…è®¸çš„è¿›ç¨‹ï¼š

```
Next.js å‰ç«¯ï¼ˆ3000ï¼‰
Node.js åç«¯ï¼ˆ8000ï¼‰
```

Nginx ç»“æ„ï¼š

```
/        â†’ 3000
/api/*   â†’ 8000
```

æ’ä»¶åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼š

```
backend/plugins/*
```

æ’ä»¶ä¸ä¼šå¯åŠ¨ç‹¬ç«‹æœåŠ¡æˆ–ç«¯å£ã€‚

---

## 6. æ˜ç¡®ç¦æ­¢çš„é”™è¯¯åšæ³•

ä»¥ä¸‹å‡è§†ä¸ºé”™è¯¯éƒ¨ç½²ï¼š

* æ’ä»¶å¼€æ–° Node æœåŠ¡
* æ’ä»¶ç›‘å¬ç«¯å£
* æ’ä»¶ç‹¬ç«‹éƒ¨ç½²
* æ’ä»¶å†™ç‹¬ç«‹ Docker
* æ’ä»¶æ·»åŠ ç‹¬ç«‹ Nginx upstream
* å°†æ’ä»¶ç†è§£ä¸ºç¬¬äºŒå¥—å·¥å…·ç³»ç»Ÿ

---

## 7. AI å»ºè®®æ ¡éªŒè§„åˆ™

å¦‚æœ AI å»ºè®®å‡ºç°ï¼š

* æ–°æœåŠ¡
* æ–°ç«¯å£
* æ’ä»¶å•ç‹¬è¿è¡Œ
* å·¥å…·ç‹¬ç«‹éƒ¨ç½²
* ç¬¬äºŒä¸ªç³»ç»Ÿ

å…¨éƒ¨åˆ¤å®šä¸ºä¸é€‚ç”¨äºæœ¬é¡¹ç›®ã€‚

---

## 8. æ’ä»¶éƒ¨ç½²è‡ªæ£€æ¸…å•

ä¸Šçº¿å‰ç¡®è®¤ï¼š

* [ ] VPS ä¸Šåªæœ‰ 2 ä¸ª Node è¿›ç¨‹
* [ ] Nginx åªæœ‰ 1 ä¸ª server block
* [ ] æ’ä»¶ä»…ä½äº `/backend/plugins/`
* [ ] æ’ä»¶ä¸ç›‘å¬ä»»ä½•ç«¯å£
* [ ] æ’ä»¶ä»…é€šè¿‡ä¸»åç«¯ API è°ƒç”¨
* [ ] å‰ç«¯æœªä¸ºæ’ä»¶ç¼–å†™ä¸“ç”¨ä»£ç 
* [ ] ui.json / schema.json æ ¼å¼æ­£ç¡®

å…¨éƒ¨æ»¡è¶³åˆ™æ¥å…¥æ­£ç¡®ã€‚

---

## 9. æ ¸å¿ƒåŸåˆ™

* æ’ä»¶å¼€å‘å¯ç‹¬ç«‹ï¼Œè¿è¡Œå¿…é¡»åˆå¹¶
* å•ä½“éƒ¨ç½²æ˜¯äº‹å®æ¶æ„
* æ’ä»¶ç³»ç»Ÿè´Ÿè´£æ‰©å±•ï¼Œä¸è´Ÿè´£éƒ¨ç½²
* ä»»ä½•ç ´åå•ä½“æ¶æ„çš„å»ºè®®å‡ä¸ºé”™è¯¯

---

## 10. æ’ä»¶ UI & Schema è§„èŒƒï¼ˆå®Œå…¨é‡å†™ç‰ˆ Â· ä¸ä¸»ç«™ä»£ç ä¿æŒä¸€è‡´ï¼‰

**é€‚ç”¨ä½ç½®ï¼š**
- `backend/plugins/{plugin}/plugin.json`
- `backend/plugins/{plugin}/schema.json`
- `backend/plugins/{plugin}/ui.json`

**å¯¹åº”ä»£ç ä½ç½®ï¼š**
- `backend/src/plugin-loader.ts:4-9` â€” PluginConfig
- `backend/src/plugin-loader.ts:11-18` â€” PluginUI
- `backend/src/plugin-loader.ts:20-35` â€” PluginSchema

---

### 10.1 PluginConfigï¼ˆplugin.jsonï¼‰

ä¸»ç«™ä¼šè¯»å– `plugin.json` æ¥ç¡®å®šæ’ä»¶çš„åˆ†ç±»ã€æ ‡è¯†ç¬¦ã€API è·¯å¾„ç­‰ã€‚

```json
{
  "slug": "pdf-split",
  "category": "pdf",
  "apiPath": "/api/pdf/pdf-split",
  "order": 1
}
```

**å­—æ®µè¯´æ˜ï¼š**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | ä½œç”¨ |
|------|------|------|------|
| slug | string | æ˜¯ | å·¥å…·å”¯ä¸€æ ‡è¯† |
| category | string | æ˜¯ | å·¥å…·åˆ†ç±»ç›®å½• |
| apiPath | string | æ˜¯ | API å®Œæ•´è·¯å¾„ |
| order | number | æ˜¯ | åŒåˆ†ç±»ä¸‹çš„æ’åºé¡ºåº |

---

### 10.2 PluginUIï¼ˆui.jsonï¼‰

å‰ç«¯ UI å®Œå…¨ä¾èµ– `ui.json` ç”Ÿæˆé¡µé¢å†…å®¹ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€æè¿°ã€å›¾æ ‡ã€FAQ ç­‰ã€‚

**ğŸ“Œ ui.json çœŸå®ç»“æ„ï¼ˆæ¥è‡ª plugin-loader.tsï¼‰**

```typescript
interface PluginUI {
  title: Record<string, string>;
  description: Record<string, string>;
  h1: Record<string, string>;
  icon: string;
  faq: Record<string, Array<{ question: string; answer: string }>>;
  categoryName?: Record<string, string>;
}
```

**ğŸ“„ ui.json æ¨¡æ¿ï¼ˆå®Œå…¨å¯ç”¨ï¼‰**

```json
{
  "title": {
    "en": "Split PDF Online",
    "zh": "PDF åˆ†å‰²å·¥å…·"
  },
  "description": {
    "en": "Split PDF pages into multiple files online.",
    "zh": "å°† PDF é¡µé¢åœ¨çº¿åˆ†å‰²æˆå¤šä¸ªæ–‡ä»¶ã€‚"
  },
  "h1": {
    "en": "Split Your PDF",
    "zh": "æ‹†åˆ† PDF æ–‡ä»¶"
  },
  "icon": "pdf-split",
  "faq": {
    "en": [
      {
        "question": "Is this tool free?",
        "answer": "Yes, it's completely free."
      }
    ],
    "zh": [
      {
        "question": "è¿™ä¸ªå·¥å…·å…è´¹å—ï¼Ÿ",
        "answer": "æ˜¯çš„ï¼Œå®Œå…¨å…è´¹ã€‚"
      }
    ]
  },
  "categoryName": {
    "en": "PDF Tools",
    "zh": "PDF å·¥å…·"
  }
}
```

---

### 10.3 PluginSchemaï¼ˆschema.jsonï¼‰

`schema` è´Ÿè´£æè¿°è¡¨å•ç•Œé¢ç»“æ„ï¼šä¸Šä¼ æ–‡ä»¶ã€é€‰é¡¹å­—æ®µã€æäº¤æŒ‰é’®ç­‰ã€‚

**ğŸ“Œ schema.json çœŸå®ç»“æ„ï¼ˆæ¥è‡ª plugin-loader.tsï¼‰**

```typescript
interface PluginSchema {
  upload: {
    multiple: boolean;
    maxFiles: number;
    types: string[];
    maxSize: number;
  };
  options: Array<{
    name: string;
    type: string;
    label: Record<string, string>;
    [key: string]: any;
  }>;
  submitText: Record<string, string>;
  outputType: string;
}
```

**ğŸ“„ schema.json æ¨¡æ¿ï¼ˆå®Œå…¨å¯ç”¨ï¼‰**

```json
{
  "upload": {
    "multiple": false,
    "maxFiles": 1,
    "types": ["pdf"],
    "maxSize": 50
  },
  "options": [
    {
      "name": "range",
      "type": "text",
      "label": {
        "en": "Page Range",
        "zh": "æ‹†åˆ†é¡µé¢èŒƒå›´"
      }
    }
  ],
  "submitText": {
    "en": "Split PDF",
    "zh": "æ‹†åˆ† PDF"
  },
  "outputType": "file"
}
```

---

### 10.4 å‰ç«¯å¦‚ä½•æ¸²æŸ“ PluginSchema

ä¸»ç«™å‰ç«¯æ‰§è¡Œä»¥ä¸‹è¡Œä¸ºï¼š

| schema å­—æ®µ | å‰ç«¯è¡¨ç° |
|------------|---------|
| upload | æ¸²æŸ“ä¸Šä¼ æ–‡ä»¶åŒºåŸŸï¼ˆå•/å¤šæ–‡ä»¶ã€æ•°é‡é™åˆ¶ã€æ–‡ä»¶ç±»å‹ã€å¤§å°é™åˆ¶ï¼‰ |
| options | æ¸²æŸ“è¾“å…¥æ¡†ã€ä¸‹æ‹‰æ¡†ã€å¼€å…³ç­‰ UI ç»„ä»¶ |
| submitText | æ˜¾ç¤ºæäº¤æŒ‰é’®æ–‡æœ¬ |
| outputType | ç”¨äºæ¸²æŸ“è¾“å‡ºç»“æœç±»å‹ï¼ˆfile / image / textï¼‰ |

---

### 10.5 æ’ä»¶æ–‡ä»¶ç»“æ„ï¼ˆæœ€ç»ˆæ ‡å‡†ï¼‰

```
backend/plugins/{your-plugin}/
  â”œâ”€â”€ handler/
  â”‚   â””â”€â”€ index.ts     # å¿…é¡»ï¼šæ‰§è¡Œä¸»é€»è¾‘
  â”œâ”€â”€ plugin.json      # å¿…é¡»ï¼šåˆ†ç±»ã€slugã€APIè·¯å¾„ã€æ’åº
  â”œâ”€â”€ ui.json          # å¿…é¡»ï¼šæ ‡é¢˜ã€æè¿°ã€FAQã€å›¾æ ‡
  â”œâ”€â”€ schema.json      # å¯é€‰ï¼šUI è¡¨å•å®šä¹‰
```

---

### 10.6 ä¸€ä¸ªå®Œæ•´ç¤ºä¾‹æ’ä»¶

```
backend/plugins/pdf-split/
  â”œâ”€â”€ handler/
  â”‚   â””â”€â”€ index.ts
  â”œâ”€â”€ schema.json
  â”œâ”€â”€ ui.json
  â”œâ”€â”€ plugin.json
```

---

## 11. æ–‡æ¡£åœ°ä½

å½“å…¶ä»–æ–‡æ¡£ã€AI å»ºè®®æˆ–ä¸ªäººæƒ³æ³•ä¸æœ¬è§„èŒƒå†²çªæ—¶ï¼š

**ä»¥æœ¬æŒ‡ç¤ºæ–‡æ¡£ v2.0 ä¸ºå‡†ã€‚**

---

