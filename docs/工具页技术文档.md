# å·¥å…·é¡µæŠ€æœ¯æ–‡æ¡£ v1.0

é€‚ç”¨äº PDF-TOOLS / IMAGE-TOOLS / æ‰€æœ‰æœªæ¥å·¥å…·

---

## ä¸€ã€æ¦‚è¿°

### 1.1 æ–‡æ¡£ç›®çš„

æœ¬æŠ€æœ¯æ–‡æ¡£ç”¨äºæŒ‡å¯¼ï¼š

- æ„å»º"æ’ä»¶é©±åŠ¨"çš„å‰ç«¯å·¥å…·é¡µé¢
- ä½¿ç”¨ ui.json æ§åˆ¶æ–‡æ¡ˆ/UI/SEO
- ä½¿ç”¨ schema.json æ§åˆ¶åŠ¨æ€é€‰é¡¹ä¸è¡¨å•
- ä½¿ç”¨ handler æ§åˆ¶å·¥å…·æ ¸å¿ƒé€»è¾‘
- å·¥å…·é¡µé¢å¦‚ä½•é€šè¿‡ SSR å®Œæ•´æ¸²æŸ“ SEO

### 1.2 æ ¸å¿ƒåŸç†

å·¥å…·é¡µ = çº¯å±•ç¤ºå±‚ï¼ˆUI Shellï¼‰ + æ’ä»¶æ•°æ®é©±åŠ¨

```
ç”¨æˆ·è®¿é—® /{locale}/{categoryId}/{slug}
         â†“
åç«¯æ’ä»¶ç³»ç»Ÿè¯»å– JSON é…ç½®
         â†“
Next.js SSR ç”Ÿæˆ SEO
         â†“
SchemaRenderer åŠ¨æ€æ¸²æŸ“ UI
         â†“
ç”¨æˆ·æäº¤ â†’ POST /api/{category}/{slug} â†’ handler å¤„ç†
```

å‰ç«¯ä¸åŒ…å«ä»»ä½•ä¸šåŠ¡é€»è¾‘ï¼Œæ‰€æœ‰å·¥å…·é€»è¾‘åœ¨åç«¯ handler ä¸­å®ç°ã€‚

### 1.3 è·¯ç”±è§„èŒƒ

```
/{locale}/{categoryId}/{slug}
```

| URL | è¯´æ˜ |
|-----|------|
| `/zh/pdf-tools/merge` | ä¸­æ–‡ PDF åˆå¹¶å·¥å…· |
| `/en/pdf-tools/split` | è‹±æ–‡ PDF æ‹†åˆ†å·¥å…· |
| `/es/image-tools/resize` | è¥¿ç­ç‰™è¯­å›¾ç‰‡è°ƒæ•´å·¥å…· |

| å­—æ®µ       | è¯´æ˜                                |
| ---------- | ----------------------------------- |
| locale     | å¤šè¯­è¨€ï¼ˆen / zh / esï¼‰              |
| categoryId | å‰ç«¯åˆ†ç±»åï¼ˆpdf-tools / image-toolsï¼‰|
| slug       | å·¥å…·å”¯ä¸€æ ‡è¯†                        |

---

## äºŒã€æ’ä»¶ç›®å½•ç»“æ„

æ‰€æœ‰æ’ä»¶å¿…é¡»æ”¾åœ¨ `backend/plugins/` ç›®å½•ä¸‹ï¼š

```
backend/plugins/
â”œâ”€â”€ pdf-merge/
â”‚   â”œâ”€â”€ plugin.json      # å¿…éœ€ï¼šæ’ä»¶é…ç½®
â”‚   â”œâ”€â”€ ui.json          # å¿…éœ€ï¼šUI å’Œ SEO é…ç½®
â”‚   â”œâ”€â”€ schema.json      # å¿…éœ€ï¼šè¡¨å•é…ç½®
â”‚   â””â”€â”€ handler/
â”‚       â””â”€â”€ index.ts     # å¿…éœ€ï¼šå¤„ç†é€»è¾‘
â”œâ”€â”€ pdf-split/
â”‚   â””â”€â”€ ...
â””â”€â”€ image-resize/
    â””â”€â”€ ...
```

**å‘½åè§„èŒƒ**ï¼š
- ç›®å½•åä½¿ç”¨çŸ­æ¨ªçº¿è¿æ¥ï¼š`pdf-merge`ã€`image-resize`
- æ‰€æœ‰æ–‡ä»¶åå¿…é¡»å…¨å°å†™
- ç›®å½•åå»ºè®®ä¸ slug ä¿æŒä¸€è‡´

---

## ä¸‰ã€æ ¸å¿ƒé…ç½®æ–‡ä»¶

### 3.1 plugin.json

ç”¨äºè®©ç³»ç»Ÿè¯†åˆ«å·¥å…·å±äºå“ªä¸ªåˆ†ç±»ã€ç”¨ä»€ä¹ˆ slug æ‰“å¼€ã€‚

```json
{
  "slug": "merge",
  "category": "pdf",
  "apiPath": "/api/pdf/merge",
  "order": 1
}
```

| å­—æ®µ     | ç±»å‹   | å¿…å¡« | è¯´æ˜                              |
| -------- | ------ | ---- | --------------------------------- |
| slug     | string | âœ…   | å·¥å…·å”¯ä¸€ IDï¼Œç”¨äº URL å’Œ API æŸ¥è¯¢ |
| category | string | âœ…   | åç«¯ API åˆ†ç±»ï¼ˆpdf / imageï¼‰      |
| apiPath  | string | âœ…   | handler API è·¯å¾„                  |
| order    | number | âœ…   | åˆ†ç±»é¡µæ’åºï¼ˆæ•°å­—è¶Šå°è¶Šé å‰ï¼‰      |

---

### 3.2 ui.json

åŒ…å« SEOã€UI æ–‡æ¡ˆã€FAQã€æ ‡é¢˜ç­‰ã€‚

```json
{
  "title": {
    "en": "Merge PDF Online",
    "zh": "åœ¨çº¿åˆå¹¶ PDF",
    "es": "Fusionar PDF en lÃ­nea"
  },
  "description": {
    "en": "Merge multiple PDF files into one document quickly and easily.",
    "zh": "å¿«é€Ÿè½»æ¾åœ°å°†å¤šä¸ª PDF æ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡æ¡£ã€‚",
    "es": "Combine varios archivos PDF en un documento de forma rÃ¡pida y sencilla."
  },
  "h1": {
    "en": "Merge PDF",
    "zh": "åˆå¹¶ PDF",
    "es": "Fusionar PDF"
  },
  "icon": "ğŸ“„",
  "categoryName": {
    "en": "PDF Tools",
    "zh": "PDF å·¥å…·",
    "es": "Herramientas PDF"
  },
  "faq": {
    "en": [
      {
        "question": "How do I merge PDF files?",
        "answer": "Upload your PDF files, arrange them in the desired order, and click the merge button."
      }
    ],
    "zh": [
      {
        "question": "å¦‚ä½•åˆå¹¶ PDF æ–‡ä»¶ï¼Ÿ",
        "answer": "ä¸Šä¼ æ‚¨çš„ PDF æ–‡ä»¶ï¼ŒæŒ‰æ‰€éœ€é¡ºåºæ’åˆ—ï¼Œç„¶åç‚¹å‡»åˆå¹¶æŒ‰é’®ã€‚"
      }
    ]
  }
}
```

| å­—æ®µ         | ç±»å‹                   | å¿…å¡« | è¯´æ˜             |
| ------------ | ---------------------- | ---- | ---------------- |
| title        | Record<string, string> | âœ…   | SEO æ ‡é¢˜         |
| description  | Record<string, string> | âœ…   | SEO æè¿°         |
| h1           | Record<string, string> | âœ…   | é¡µé¢ H1 æ ‡é¢˜     |
| icon         | string                 | âœ…   | å·¥å…·å›¾æ ‡ï¼ˆemojiï¼‰|
| categoryName | Record<string, string> | âŒ   | åˆ†ç±»åç§°ï¼ˆå¯é€‰ï¼‰ |
| faq          | Record<string, FAQ[]>  | âŒ   | å¸¸è§é—®é¢˜åˆ—è¡¨     |

âš ï¸ **FAQ æ ¼å¼**ï¼šå¿…é¡»ä½¿ç”¨ `question` å’Œ `answer`ï¼Œä¸æ˜¯ `q` å’Œ `a`ã€‚

---

### 3.3 schema.json

å®šä¹‰å·¥å…·é¡µé¢ UIï¼ŒåŒ…æ‹¬ä¸Šä¼ åŒºåŸŸã€æŒ‰é’®ã€å‚æ•°è¾“å…¥ç­‰ã€‚

```json
{
  "upload": {
    "multiple": true,
    "maxFiles": 20,
    "types": ["application/pdf"],
    "maxSize": 104857600
  },
  "options": [],
  "submitText": {
    "en": "Merge PDF",
    "zh": "åˆå¹¶ PDF",
    "es": "Fusionar PDF"
  },
  "outputType": "file"
}
```

#### upload é…ç½®

| å­—æ®µ     | ç±»å‹     | è¯´æ˜                                    |
| -------- | -------- | --------------------------------------- |
| multiple | boolean  | æ˜¯å¦å…è®¸å¤šæ–‡ä»¶ä¸Šä¼                       |
| maxFiles | number   | æœ€å¤§æ–‡ä»¶æ•°é‡                            |
| types    | string[] | å…è®¸çš„ MIME ç±»å‹                        |
| maxSize  | number   | å•æ–‡ä»¶æœ€å¤§å¤§å°ï¼ˆå­—èŠ‚ï¼Œ100MB=104857600ï¼‰ |

#### outputType

| å€¼   | è¯´æ˜           |
| ---- | -------------- |
| file | è¿”å›å•ä¸ªæ–‡ä»¶   |
| zip  | è¿”å› ZIP å‹ç¼©åŒ…|
| json | è¿”å› JSON æ•°æ® |

#### options é…ç½®

æ”¯æŒçš„é€‰é¡¹ç±»å‹ï¼š

**checkbox**
```json
{
  "name": "removeMetadata",
  "type": "checkbox",
  "label": { "en": "Remove metadata", "zh": "ç§»é™¤å…ƒæ•°æ®" },
  "checkboxLabel": { "en": "Yes, remove", "zh": "æ˜¯ï¼Œç§»é™¤" },
  "default": false
}
```

**select**
```json
{
  "name": "quality",
  "type": "select",
  "label": { "en": "Quality", "zh": "è´¨é‡" },
  "choices": [
    { "value": "high", "label": { "en": "High", "zh": "é«˜" } },
    { "value": "medium", "label": { "en": "Medium", "zh": "ä¸­" } },
    { "value": "low", "label": { "en": "Low", "zh": "ä½" } }
  ],
  "default": "medium"
}
```

**number**
```json
{
  "name": "dpi",
  "type": "number",
  "label": { "en": "DPI", "zh": "åˆ†è¾¨ç‡" },
  "placeholder": "150",
  "min": 72,
  "max": 300,
  "default": 150
}
```

**range**
```json
{
  "name": "compression",
  "type": "range",
  "label": { "en": "Compression Level", "zh": "å‹ç¼©çº§åˆ«" },
  "min": 0,
  "max": 100,
  "default": 50
}
```

**text**
```json
{
  "name": "filename",
  "type": "text",
  "label": { "en": "Output filename", "zh": "è¾“å‡ºæ–‡ä»¶å" },
  "placeholder": "merged"
}
```

---

### 3.4 handler/index.ts

åç«¯å¤„ç†ç¨‹åºï¼ŒExpress ä¼šè‡ªåŠ¨æŒ‚è½½ APIã€‚

```typescript
import { Request, Response } from 'express';
import { PDFDocument } from 'pdf-lib';

export default async function handler(req: Request, res: Response) {
  try {
    // è·å–ä¸Šä¼ çš„æ–‡ä»¶
    const files = req.files as Express.Multer.File[];

    if (!files || files.length === 0) {
      return res.status(400).json({ error: 'No files uploaded' });
    }

    // è·å–é€‰é¡¹å‚æ•°ï¼ˆå€¼ä¸ºå­—ç¬¦ä¸²ï¼‰
    const removeMetadata = req.body.removeMetadata === 'true';

    // å¤„ç†é€»è¾‘
    const mergedPdf = await PDFDocument.create();

    for (const file of files) {
      const pdf = await PDFDocument.load(file.buffer);
      const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
      pages.forEach(page => mergedPdf.addPage(page));
    }

    const pdfBytes = await mergedPdf.save();

    // è¿”å›æ–‡ä»¶
    res.setHeader('Content-Type', 'application/pdf');
    res.setHeader('Content-Disposition', 'attachment; filename="merged.pdf"');
    res.send(Buffer.from(pdfBytes));
  } catch (error) {
    console.error('Processing failed:', error);
    res.status(500).json({ error: 'Processing failed' });
  }
}
```

**é‡è¦**ï¼š
- ä½¿ç”¨ `export default`ï¼Œä¸æ˜¯ `module.exports`
- å•æ–‡ä»¶ä¸Šä¼ ï¼š`req.file`
- å¤šæ–‡ä»¶ä¸Šä¼ ï¼š`req.files`
- é€‰é¡¹å‚æ•°åœ¨ `req.body` ä¸­ï¼Œå€¼ä¸ºå­—ç¬¦ä¸²

---

## å››ã€å‰ç«¯æ¶æ„

### 4.1 æ–‡ä»¶ä½ç½®

```
frontend/main/src/
â”œâ”€â”€ app/[locale]/[categoryId]/[slug]/
â”‚   â””â”€â”€ page.tsx              # å·¥å…·é¡µä¸»ç»„ä»¶
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ tool/
â”‚   â”‚   â””â”€â”€ SchemaRenderer.tsx  # è¡¨å•æ¸²æŸ“å™¨
â”‚   â””â”€â”€ layout/
â”‚       â””â”€â”€ Breadcrumb.tsx      # é¢åŒ…å±‘å¯¼èˆª
â””â”€â”€ lib/
    â””â”€â”€ api.ts                  # API è°ƒç”¨å°è£…
```

### 4.2 é¡µé¢ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Header                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Breadcrumb (é¦–é¡µ > åˆ†ç±» > å·¥å…·)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           å·¥å…·å›¾æ ‡                   â”‚
â”‚           å·¥å…·æ ‡é¢˜ (h1)              â”‚
â”‚           å·¥å…·æè¿°                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      SchemaRenderer           â”‚  â”‚
â”‚  â”‚  - æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ                â”‚  â”‚
â”‚  â”‚  - å·²é€‰æ–‡ä»¶åˆ—è¡¨                â”‚  â”‚
â”‚  â”‚  - é€‰é¡¹è¡¨å•                    â”‚  â”‚
â”‚  â”‚  - æäº¤æŒ‰é’®                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           FAQ åŒºåŸŸ                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            Footer                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 SchemaRenderer ç»„ä»¶

ä½ç½®ï¼š`frontend/main/src/components/tool/SchemaRenderer.tsx`

åŠŸèƒ½ï¼š
- æ ¹æ® schema.upload æ¸²æŸ“æ–‡ä»¶ä¸Šä¼ åŒºåŸŸï¼ˆæ”¯æŒæ‹–æ‹½ï¼‰
- æ ¹æ® schema.options åŠ¨æ€æ¸²æŸ“è¡¨å•é€‰é¡¹
- æ ¹æ® schema.submitText æ¸²æŸ“æäº¤æŒ‰é’®
- è°ƒç”¨åç«¯ API è§¦å‘ handler
- å¤„ç†æ–‡ä»¶ä¸‹è½½

### 4.4 PluginData ç±»å‹å®šä¹‰

```typescript
export interface PluginData {
  slug: string;           // å·¥å…·å”¯ä¸€æ ‡è¯†
  category: string;       // åˆ†ç±»: pdf, image
  apiPath: string;        // API è·¯å¾„
  order: number;          // æ’åº
  title: string;          // æ ‡é¢˜ (å·²æœ¬åœ°åŒ–)
  description: string;    // æè¿° (å·²æœ¬åœ°åŒ–)
  h1: string;             // H1 æ ‡é¢˜ (å·²æœ¬åœ°åŒ–)
  icon: string;           // å›¾æ ‡ emoji
  faq: Array<{            // FAQ åˆ—è¡¨ (å·²æœ¬åœ°åŒ–)
    question: string;
    answer: string;
  }>;
  schema: {
    upload: {
      multiple: boolean;
      maxFiles: number;
      types: string[];
      maxSize: number;
    };
    options: Array<{
      name: string;
      type: string;
      label: string;
      placeholder?: string;
      min?: number;
      max?: number;
      default?: any;
      choices?: Array<{ value: string; label: string }>;
      checkboxLabel?: string;
    }>;
    submitText: string;
    outputType: string;
  };
}
```

---

## äº”ã€éƒ¨ç½²æµç¨‹

### ç¬¬ 1 æ­¥ï¼šåˆ›å»ºæ’ä»¶ç›®å½•

```bash
cd /var/www/toolibox
mkdir -p backend/plugins/pdf-merge/handler
```

### ç¬¬ 2 æ­¥ï¼šåˆ›å»ºå››ä¸ªæ–‡ä»¶

åœ¨ `backend/plugins/pdf-merge/` ç›®å½•ä¸‹åˆ›å»ºï¼š
- plugin.json
- ui.json
- schema.json
- handler/index.ts

### ç¬¬ 3 æ­¥ï¼šé‡å¯åç«¯

```bash
# Docker éƒ¨ç½²
docker-compose restart backend-main

# æˆ–é‡æ–°æ„å»º
docker-compose build backend-main && docker-compose up -d
```

åå°æ—¥å¿—åº”å‡ºç°ï¼š

```
âœ… Loaded plugin: pdf-merge
```

### ç¬¬ 4 æ­¥ï¼šæµ‹è¯•å·¥å…·é¡µé¢

æµè§ˆå™¨è®¿é—®ï¼š

```
https://yourdomain.com/en/pdf-tools/merge
https://yourdomain.com/zh/pdf-tools/merge
```

---

## å…­ã€API æ¥å£

### è·å–æ‰€æœ‰æ’ä»¶

```
GET /api/plugins?lang=zh
```

å“åº”ï¼š

```json
{
  "success": true,
  "data": {
    "plugins": [...],
    "categories": {
      "pdf": [...],
      "image": [...]
    }
  }
}
```

### è·å–å•ä¸ªæ’ä»¶

```
GET /api/plugins/{slug}?lang=zh
```

å“åº”ï¼š

```json
{
  "success": true,
  "data": {
    "slug": "merge",
    "category": "pdf",
    "apiPath": "/api/pdf/merge",
    "title": "åˆå¹¶ PDF",
    "description": "...",
    "h1": "...",
    "icon": "ğŸ“„",
    "faq": [...],
    "schema": {...}
  }
}
```

### è°ƒç”¨å·¥å…· API

```
POST /api/{category}/{slug}
Content-Type: multipart/form-data

files: [File, File, ...]
option1: value1
option2: value2
```

---

## ä¸ƒã€åç«¯æ’ä»¶åŠ è½½æœºåˆ¶

è·¯å¾„ï¼š`backend/src/plugin-loader.ts`

å¯åŠ¨æ—¶æ‰§è¡Œï¼š
1. æ‰«æ `backend/plugins/*`
2. è¯»å–æ¯ä¸ªæ’ä»¶çš„ JSON é…ç½®å’Œ handler
3. è‡ªåŠ¨æŒ‚è½½ APIï¼š`/api/{category}/{slug}`
4. å‘å‰ç«¯æä¾›æ’ä»¶åˆ—è¡¨

æ–°å¢æ’ä»¶æ— éœ€ä¿®æ”¹ä»»ä½•å‰ç«¯æˆ–ä¸»åç«¯ä»£ç ï¼Œåªéœ€é‡å¯åç«¯ã€‚

---

## å…«ã€å¸¸è§é—®é¢˜æ’æŸ¥

| é—®é¢˜                | åŸå›                                 |
| ------------------- | ----------------------------------- |
| å·¥å…·é¡µ 404          | plugin.json çš„ slug å†™é”™            |
| å·¥å…·é¡µå†…å®¹ä¸æ˜¾ç¤º    | schema.json æ ¼å¼ä¸æ­£ç¡®              |
| SEO ä¸æ˜¾ç¤º          | ui.json ç¼ºå°‘ title/description      |
| ç‚¹å‡»æŒ‰é’®æŠ¥é”™        | handler/index.ts è·¯å¾„æˆ–è¿”å›æ–‡ä»¶é”™è¯¯ |
| API ä¸åŠ è½½          | åç«¯æœªé‡å¯ã€æ–‡ä»¶åå¤§å°å†™é”™è¯¯        |
| åˆ†ç±»é¡µæ— æ³•æ˜¾ç¤ºå·¥å…·  | plugin.json ä¸­ category å¡«é”™        |
| FAQ ä¸æ˜¾ç¤º          | ä½¿ç”¨äº† q/a è€Œä¸æ˜¯ question/answer   |
| é€‰é¡¹ä¸æ¸²æŸ“          | schema.options æ ¼å¼é”™è¯¯             |

---

## ä¹ã€å®Œæ•´æ’ä»¶ç¤ºä¾‹

### ç›®å½•ç»“æ„

```
backend/plugins/pdf-merge/
â”œâ”€â”€ plugin.json
â”œâ”€â”€ ui.json
â”œâ”€â”€ schema.json
â””â”€â”€ handler/
    â””â”€â”€ index.ts
```

### plugin.json

```json
{
  "slug": "merge",
  "category": "pdf",
  "apiPath": "/api/pdf/merge",
  "order": 1
}
```

### ui.json

```json
{
  "title": {
    "en": "Merge PDF Online",
    "zh": "åœ¨çº¿åˆå¹¶ PDF"
  },
  "description": {
    "en": "Combine multiple PDF files into one document.",
    "zh": "å°†å¤šä¸ª PDF æ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡æ¡£ã€‚"
  },
  "h1": {
    "en": "Merge PDF",
    "zh": "åˆå¹¶ PDF"
  },
  "icon": "ğŸ“„",
  "faq": {
    "en": [
      { "question": "How to merge?", "answer": "Upload and click merge." }
    ],
    "zh": [
      { "question": "å¦‚ä½•åˆå¹¶ï¼Ÿ", "answer": "ä¸Šä¼ æ–‡ä»¶åç‚¹å‡»åˆå¹¶ã€‚" }
    ]
  }
}
```

### schema.json

```json
{
  "upload": {
    "multiple": true,
    "maxFiles": 20,
    "types": ["application/pdf"],
    "maxSize": 104857600
  },
  "options": [],
  "submitText": {
    "en": "Merge PDF",
    "zh": "åˆå¹¶ PDF"
  },
  "outputType": "file"
}
```

### handler/index.ts

```typescript
import { Request, Response } from 'express';
import { PDFDocument } from 'pdf-lib';

export default async function handler(req: Request, res: Response) {
  try {
    const files = req.files as Express.Multer.File[];
    if (!files || files.length < 2) {
      return res.status(400).json({ error: 'Please upload at least 2 files' });
    }

    const mergedPdf = await PDFDocument.create();

    for (const file of files) {
      const pdf = await PDFDocument.load(file.buffer);
      const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
      pages.forEach(page => mergedPdf.addPage(page));
    }

    const pdfBytes = await mergedPdf.save();

    res.setHeader('Content-Type', 'application/pdf');
    res.setHeader('Content-Disposition', 'attachment; filename="merged.pdf"');
    res.send(Buffer.from(pdfBytes));
  } catch (error) {
    console.error('Merge failed:', error);
    res.status(500).json({ error: 'Merge failed' });
  }
}
```

---

## åã€éªŒæ”¶æ ‡å‡†

éƒ¨ç½²æˆåŠŸæ—¶ï¼š

- âœ… åˆ†ç±»é¡µ /pdf-tools è‡ªåŠ¨å‡ºç°å·¥å…·å¡ç‰‡
- âœ… å·¥å…·é¡µè‡ªåŠ¨å½¢æˆ URL
- âœ… SEO è‡ªåŠ¨æ¸²æŸ“ï¼ˆtitle, descriptionï¼‰
- âœ… ä¸Šä¼ ç»„ä»¶æ­£å¸¸å·¥ä½œ
- âœ… é€‰é¡¹è¡¨å•æ­£ç¡®æ¸²æŸ“
- âœ… åç«¯ handler å¯æ­£å¸¸å¤„ç†
- âœ… è¿”å›æ–‡ä»¶å¯ä¸‹è½½

---

## åä¸€ã€å¿«é€Ÿå‚è€ƒ

### æ–°å¢å·¥å…·åªéœ€ï¼š

```
backend/plugins/{tool}/
â”œâ”€â”€ plugin.json
â”œâ”€â”€ ui.json
â”œâ”€â”€ schema.json
â””â”€â”€ handler/index.ts
```

ç„¶åé‡å¯åç«¯ï¼š

```bash
docker-compose restart backend-main
```

### ä¸éœ€è¦ï¼š

- âŒ ä¿®æ”¹å¯¼èˆªé¡µ
- âŒ ä¿®æ”¹å‰ç«¯ä»£ç 
- âŒ ä¿®æ”¹åç«¯ä»£ç 
- âŒ é‡æ–°éƒ¨ç½²å‰ç«¯

å‰ç«¯å’Œè·¯ç”±å…¨éƒ¨è‡ªåŠ¨ç”Ÿæˆã€‚

---

## åäºŒã€æ³¨æ„äº‹é¡¹

1. **æœåŠ¡ç«¯æ¸²æŸ“**ï¼šå·¥å…·é¡µä½¿ç”¨ Next.js æœåŠ¡ç«¯æ¸²æŸ“ï¼ŒSEO å‹å¥½
2. **å®¢æˆ·ç«¯äº¤äº’**ï¼šSchemaRenderer æ˜¯å®¢æˆ·ç«¯ç»„ä»¶ (`'use client'`)
3. **æ–‡ä»¶å¤§å°**ï¼šé»˜è®¤é™åˆ¶ 100MBï¼Œå¯åœ¨ schema.json ä¸­é…ç½®
4. **å›½é™…åŒ–**ï¼šæ‰€æœ‰ç”¨æˆ·å¯è§æ–‡æœ¬éœ€æ”¯æŒ en/zh/es ä¸‰ç§è¯­è¨€
5. **é”™è¯¯å¤„ç†**ï¼šåŠ¡å¿…å¤„ç†ç½‘ç»œé”™è¯¯å’Œæ–‡ä»¶å¤„ç†é”™è¯¯
